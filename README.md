# taro flushSync issue

## ÊúÄÂ∞èÁ§∫‰æã

### taro init

> taro init taro-flushsync

```
üëΩ Taro v3.6.19

‚ö† Ëé∑Âèñ taro ÂÖ®Â±ÄÈÖçÁΩÆÊñá‰ª∂Â§±Ë¥•Ôºå‰∏çÂ≠òÂú®ÂÖ®Â±ÄÈÖçÁΩÆÊñá‰ª∂Ôºö/Users/ueaner/.taro-global-config/index.json


Taro Âç≥Â∞ÜÂàõÂª∫‰∏Ä‰∏™Êñ∞È°πÁõÆ!
Need help? Go and open issue: https://tls.jd.com/taro-issue-helper

? ËØ∑ËæìÂÖ•È°πÁõÆ‰ªãÁªç
? ËØ∑ÈÄâÊã©Ê°ÜÊû∂ React
? ÊòØÂê¶ÈúÄË¶Å‰ΩøÁî® TypeScript Ôºü Yes
? ËØ∑ÈÄâÊã© CSS È¢ÑÂ§ÑÁêÜÂô®ÔºàSass/Less/StylusÔºâ Êó†
? ËØ∑ÈÄâÊã©ÁºñËØëÂ∑•ÂÖ∑ Webpack5
? ËØ∑ÈÄâÊã©ÂåÖÁÆ°ÁêÜÂ∑•ÂÖ∑ pnpm
? ËØ∑ÈÄâÊã©Ê®°ÊùøÊ∫ê GiteeÔºàÊúÄÂø´Ôºâ
‚úî ÊãâÂèñËøúÁ®ãÊ®°Êùø‰ªìÂ∫ìÊàêÂäüÔºÅ
? ËØ∑ÈÄâÊã©Ê®°Êùø ÈªòËÆ§Ê®°Êùø

‚úî ÂàõÂª∫È°πÁõÆ: taro-flushsync
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/.editorconfig
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/.env.dev
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/.env.prod
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/.env.test
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/.eslintrc
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/.gitignore
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/babel.config.js
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/jest.config.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/package.json
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/project.config.json
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/project.tt.json
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/tsconfig.json
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/__tests__/index.test.js
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/config/dev.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/config/index.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/config/prod.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/types/global.d.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/app.config.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/app.css
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/app.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/index.html
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/pages/index/index.config.ts
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/pages/index/index.css
‚úî ÂàõÂª∫Êñá‰ª∂: /Users/ueaner/projects/frontend/taro-flushsync/src/pages/index/index.tsx

‚úî cd taro-flushsync, ÊâßË°å git init
Progress: resolved 1, reused 0, downloaded 0, added 0
Progress: resolved 35, reused 24, downloaded 0, added 0
Progress: resolved 64, reused 54, downloaded 4, added 0
Progress: resolved 157, reused 140, downloaded 6, added 0
Progress: resolved 275, reused 236, downloaded 6, added 0
Progress: resolved 351, reused 340, downloaded 6, added 0
Progress: resolved 452, reused 429, downloaded 11, added 0
Progress: resolved 606, reused 562, downloaded 13, added 0
Progress: resolved 782, reused 736, downloaded 15, added 0
Progress: resolved 967, reused 910, downloaded 17, added 0
Progress: resolved 1133, reused 1052, downloaded 18, added 0
Progress: resolved 1373, reused 1304, downloaded 19, added 0
‚ÄâWARN‚Äâ 14 deprecated subdependencies found: @babel/plugin-proposal-async-generator-functions@7.20.7, @babel/plugin-proposal-class-properties@7.18.6, @babel/plugin-proposal-nullish-coalescing-operator@7.18.6, @babel/plugin-proposal-object-rest-spread@7.20.7, @babel/plugin-proposal-optional-catch-binding@7.18.6, @babel/plugin-proposal-optional-chaining@7.21.0, @types/sass@1.45.0, consolidate@0.15.1, har-validator@5.1.5, request@2.88.2, source-map-resolve@0.6.0, stable@0.1.8, uuid@3.4.0, vm2@3.9.19
Progress: resolved 1615, reused 1544, downloaded 19, added 0
Packages: +1570
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Progress: resolved 1615, reused 1549, downloaded 20, added 52
Progress: resolved 1615, reused 1549, downloaded 20, added 297
Progress: resolved 1615, reused 1549, downloaded 20, added 401
Progress: resolved 1615, reused 1549, downloaded 20, added 523
Progress: resolved 1615, reused 1549, downloaded 20, added 716
Progress: resolved 1615, reused 1549, downloaded 20, added 839
Progress: resolved 1615, reused 1549, downloaded 20, added 947
Progress: resolved 1615, reused 1549, downloaded 20, added 1234
Progress: resolved 1615, reused 1549, downloaded 20, added 1269
Progress: resolved 1615, reused 1549, downloaded 20, added 1280
Progress: resolved 1615, reused 1549, downloaded 20, added 1388
Progress: resolved 1615, reused 1549, downloaded 20, added 1503
Progress: resolved 1615, reused 1549, downloaded 20, added 1570, done

dependencies:
+ @babel/runtime 7.23.4
+ @tarojs/components 3.6.19
+ @tarojs/helper 3.6.19
+ @tarojs/plugin-framework-react 3.6.19
+ @tarojs/plugin-platform-alipay 3.6.19
+ @tarojs/plugin-platform-h5 3.6.19
+ @tarojs/plugin-platform-jd 3.6.19
+ @tarojs/plugin-platform-qq 3.6.19
+ @tarojs/plugin-platform-swan 3.6.19
+ @tarojs/plugin-platform-tt 3.6.19
+ @tarojs/plugin-platform-weapp 3.6.19
+ @tarojs/react 3.6.19
+ @tarojs/runtime 3.6.19
+ @tarojs/shared 3.6.19
+ @tarojs/taro 3.6.19
+ react 18.2.0
+ react-dom 18.2.0

devDependencies:
+ @babel/core 7.23.3
+ @pmmmwh/react-refresh-webpack-plugin 0.5.11
+ @tarojs/cli 3.6.19
+ @tarojs/taro-loader 3.6.19
+ @tarojs/test-utils-react 0.1.1
+ @tarojs/webpack5-runner 3.6.19
+ @types/jest 29.5.9
+ @types/node 18.18.11 (20.9.3 is available)
+ @types/react 18.2.38
+ @types/webpack-env 1.18.4
+ @typescript-eslint/eslint-plugin 6.12.0
+ @typescript-eslint/parser 6.12.0
+ babel-preset-taro 3.6.19
+ eslint 8.54.0
+ eslint-config-taro 3.6.19
+ eslint-plugin-import 2.29.0
+ eslint-plugin-react 7.33.2
+ eslint-plugin-react-hooks 4.6.0
+ jest 29.7.0
+ jest-environment-jsdom 29.7.0
+ postcss 8.4.31
+ react-refresh 0.11.0 (0.14.0 is available)
+ stylelint 14.16.1 (15.11.0 is available)
+ ts-node 10.9.1
+ tsconfig-paths-webpack-plugin 4.1.0
+ typescript 5.3.2
+ webpack 5.78.0 (5.89.0 is available)

‚ÄâWARN‚Äâ Issues with peer dependencies found
.
‚îî‚îÄ‚î¨ @tarojs/webpack5-runner 3.6.19
  ‚îî‚îÄ‚î¨ vue-loader 15.11.1
    ‚îî‚îÄ‚î¨ @vue/component-compiler-utils 3.3.0
      ‚îî‚îÄ‚î¨ consolidate 0.15.1
        ‚îú‚îÄ‚îÄ ‚úï unmet peer react-dom@^16.13.1: found 18.2.0
        ‚îî‚îÄ‚îÄ ‚úï unmet peer react@^16.13.1: found 18.2.0

Done in 28.6s
‚úî ÂÆâË£ÖÊàêÂäü
ÂàõÂª∫È°πÁõÆ taro-flushsync ÊàêÂäüÔºÅ
ËØ∑ËøõÂÖ•È°πÁõÆÁõÆÂΩï taro-flushsync ÂºÄÂßãÂ∑•‰ΩúÂêßÔºÅüòù
```

### flushSync Á§∫‰æã‰ª£Á†Å

Áõ¥Êé•‰ΩøÁî® [https://zh-hans.react.dev/reference/react-dom/flushSync](https://zh-hans.react.dev/reference/react-dom/flushSync) Êèê‰æõÁöÑÁ§∫‰æã
ÂÅö‰∫Ü‰∏ÄÁÇπÁÇπÊîπÂä®Ôºå‰ª•ÈÄÇÂ∫î Taro. ËßÅ [./src/pages/index/index.tsx](./src/pages/index/index.tsx)
ÂÖ∂‰ªñÊó†ÊîπÂä®„ÄÇ

ÊûÑÂª∫‰∫ßÁîüÈîôËØØ‰ø°ÊÅØÔºåËøôÈáåËôΩÊòØ Warning, ‰ΩÜ[ÂÆûÈôÖÈ°πÁõÆ‰∏≠ÂêåÊ†∑ÁöÑÈóÆÈ¢òËøò‰∫ßÁîü‰∫Ü Error](#ÂÆûÈôÖÈ°πÁõÆÊä•Âá∫ÁöÑÈîôËØØ‰ø°ÊÅØ), ËßÅ‰∏ãÈù¢ËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØÔºåÊúÄÁªàÊó†Ê≥ïÊûÑÂª∫„ÄÇ

> pnpm run build:weapp

```
> taro-flushsync@1.0.0 build:weapp /Users/ueaner/projects/frontend/taro-flushsync
> taro build --type weapp

üëΩ Taro v3.6.19

Tips:
1. Âª∫ËÆÆÂºÄÂêØÊåÅ‰πÖÂåñÁºìÂ≠òÂäüËÉΩÔºåËÉΩÊúâÊïàÊèêÂçá‰∫åÊ¨°ÁºñËØëÈÄüÂ∫¶ÔºåËØ¶ÊÉÖËØ∑ÂèÇËÄÉ: https://docs.taro.zone/docs/config-detail#cache„ÄÇ



‚úî Webpack
  Compiled successfully in 7.24s

‚ö†Ô∏è Warnings:

    at HarmonyImportSpecifierDependency.getLinkingErrors (/Users/ueaner/projects/frontend/taro-flushsync/node_modules/.pnpm/webpack@5.78.0_@swc+core@1.3.23/node_modules/webpack/lib/dependencies/HarmonyImportDependency.js:160:8)
ModuleDependencyWarning: export 'flushSync' (imported as 'flushSync') was not found in 'react-dom' (possible exports: createPortal, createRoot, default, findDOMNode, render, unmountComponentAtNode, unstable_batchedUpdates)
```

### taro info

> taro info

```
üëΩ Taro v3.6.19


  Taro CLI 3.6.19 environment info:
    System:
      OS: macOS 12.7.1
      Shell: 5.8.1 - /bin/zsh
    Binaries:
      Node: 20.9.0 - /tmp/run-ueaner.501ovL/fnm_multishells/666_1700546716777/bin/node
      npm: 10.1.0 - /tmp/run-ueaner.501ovL/fnm_multishells/666_1700546716777/bin/npm
    npmPackages:
      @tarojs/cli: 3.6.19 => 3.6.19
      @tarojs/components: 3.6.19 => 3.6.19
      @tarojs/helper: 3.6.19 => 3.6.19
      @tarojs/plugin-framework-react: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-alipay: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-h5: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-jd: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-qq: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-swan: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-tt: 3.6.19 => 3.6.19
      @tarojs/plugin-platform-weapp: 3.6.19 => 3.6.19
      @tarojs/react: 3.6.19 => 3.6.19
      @tarojs/runtime: 3.6.19 => 3.6.19
      @tarojs/shared: 3.6.19 => 3.6.19
      @tarojs/taro: 3.6.19 => 3.6.19
      @tarojs/taro-loader: 3.6.19 => 3.6.19
      @tarojs/webpack5-runner: 3.6.19 => 3.6.19
      babel-preset-taro: 3.6.19 => 3.6.19
      eslint-config-taro: 3.6.19 => 3.6.19
      react: ^18.0.0 => 18.2.0
```

## ÂÆûÈôÖÈ°πÁõÆÊä•Âá∫ÁöÑÈîôËØØ‰ø°ÊÅØ

### build:weapp ÈîôËØØ‰ø°ÊÅØ

> pnpm run build:weapp

```
> taro build --type weapp

üëΩ Taro v3.6.19


‚úñ Webpack
  Compiled with some errors in 19.19s

‚ö†Ô∏è Warnings:

    at HarmonyImportSpecifierDependency.getLinkingErrors (/Users/ueaner/projects/frontend/hello-taro/node_modules/.pnpm/webpack@5.89.0_@swc+core@1.3.96/node_modules/webpack/lib/dependencies/HarmonyImportDependency.js:163:8)
ModuleDependencyWarning: export 'flushSync' (imported as 'flushSync') was not found in 'react-dom' (possible exports: createPortal, createRoot, default, findDOMNode, render, unmountComponentAtNode, unstable_batchedUpdates)

    at HarmonyImportSpecifierDependency.getLinkingErrors (/Users/ueaner/projects/frontend/hello-taro/node_modules/.pnpm/webpack@5.89.0_@swc+core@1.3.96/node_modules/webpack/lib/dependencies/HarmonyImportDependency.js:163:8)
ModuleDependencyWarning: export 'flushSync' (imported as 'flushSync') was not found in 'react-dom' (possible exports: createPortal, createRoot, default, findDOMNode, render, unmountComponentAtNode, unstable_batchedUpdates)

    at HarmonyImportSpecifierDependency.getLinkingErrors (/Users/ueaner/projects/frontend/hello-taro/node_modules/.pnpm/webpack@5.89.0_@swc+core@1.3.96/node_modules/webpack/lib/dependencies/HarmonyImportDependency.js:163:8)
ModuleDependencyWarning: export 'flushSync' (imported as 'flushSync') was not found in 'react-dom' (possible exports: createPortal, createRoot, default, findDOMNode, render, unmountComponentAtNode, unstable_batchedUpdates)

    at HarmonyImportSpecifierDependency.getLinkingErrors (/Users/ueaner/projects/frontend/hello-taro/node_modules/.pnpm/webpack@5.89.0_@swc+core@1.3.96/node_modules/webpack/lib/dependencies/HarmonyImportDependency.js:163:8)
ModuleDependencyWarning: export 'flushSync' (imported as 'flushSync') was not found in 'react-dom' (possible exports: createPortal, createRoot, default, findDOMNode, render, unmountComponentAtNode, unstable_batchedUpdates)

‚úñ Errors:

    at HarmonyImportSpecifierDependency.getLinkingErrors (/Users/ueaner/projects/frontend/hello-taro/node_modules/.pnpm/webpack@5.89.0_@swc+core@1.3.96/node_modules/webpack/lib/dependencies/HarmonyImportDependency.js:163:8)
ModuleDependencyError: export 'flushSync' (imported as 'ReactDOM') was not found in 'react-dom' (possible exports: createPortal, createRoot, default, findDOMNode, render, unmountComponentAtNode, unstable_batchedUpdates)

‚ÄâELIFECYCLE‚Äâ Command failed with exit code 1.
```


### dev:weapp ÈîôËØØ‰ø°ÊÅØ

> pnpm run dev:weapp

```
‚úò [ERROR] No matching export in "node_modules/.pnpm/@tarojs+react@3.6.19_react@18.2.0/node_modules/@tarojs/react/dist/react.esm.js" for import "flushSync"

    node_modules/.pnpm/@mantine+core@7.2.2_@mantine+hooks@7.2.2_@types+react@18.2.37_react-dom@18.2.0_react@18.2.0/node_modules/@mantine/core/esm/components/Collapse/use-collapse.mjs:3:9:
      3 ‚îÇ import { flushSync } from 'react-dom';
        ‚ïµ          ~~~~~~~~~

‚úò [ERROR] No matching export in "node_modules/.pnpm/@tarojs+react@3.6.19_react@18.2.0/node_modules/@tarojs/react/dist/react.esm.js" for import "flushSync"

    node_modules/.pnpm/@floating-ui+react@0.24.8_react-dom@18.2.0_react@18.2.0/node_modules/@floating-ui/react/dist/floating-ui.react.esm.js:7:23:
      7 ‚îÇ import { createPortal, flushSync } from 'react-dom';
        ‚ïµ                        ~~~~~~~~~

Ê£ÄÊµãÂà∞‰æùËµñÁºñËØëÈîôËØØÔºåÂ∑≤Ë∑≥Ëøá @mantine/core„ÄÅreact ‰æùËµñÈ¢ÑÁºñËØë„ÄÇ
    > ÂèØ‰ª•ÈÄöËøáÊâãÂä®ÈÖçÁΩÆ compiler.prebundle.exclude (‚Äãhttps://nervjs.github.io/taro-docs/docs/next/config-detail#compilerprebundleexclude‚Äã) ÂøΩÁï•ËØ•ÊèêÁ§∫
‚úò [ERROR] No matching export in "node_modules/.pnpm/@tarojs+react@3.6.19_react@18.2.0/node_modules/@tarojs/react/dist/react.esm.js" for import "flushSync"

    node_modules/.pnpm/@mantine+core@7.2.2_@mantine+hooks@7.2.2_@types+react@18.2.37_react-dom@18.2.0_react@18.2.0/node_modules/@mantine/core/esm/components/Collapse/use-collapse.mjs:3:9:
      3 ‚îÇ import { flushSync } from 'react-dom';
        ‚ïµ          ~~~~~~~~~

‚úò [ERROR] No matching export in "node_modules/.pnpm/@tarojs+react@3.6.19_react@18.2.0/node_modules/@tarojs/react/dist/react.esm.js" for import "flushSync"

    node_modules/.pnpm/@floating-ui+react@0.24.8_react-dom@18.2.0_react@18.2.0/node_modules/@floating-ui/react/dist/floating-ui.react.esm.js:7:23:
      7 ‚îÇ import { createPortal, flushSync } from 'react-dom';
        ‚ïµ                        ~~~~~~~~~

Ê£ÄÊµãÂà∞‰æùËµñÁºñËØëÈîôËØØÔºåÂ∑≤Ë∑≥Ëøá react-dom„ÄÅreact-dom ‰æùËµñÈ¢ÑÁºñËØë„ÄÇ
    > ÂèØ‰ª•ÈÄöËøáÊâãÂä®ÈÖçÁΩÆ compiler.prebundle.exclude (‚Äãhttps://nervjs.github.io/taro-docs/docs/next/config-detail#compilerprebundleexclude‚Äã) ÂøΩÁï•ËØ•ÊèêÁ§∫
‚úò [ERROR] No matching export in "node_modules/.pnpm/@tarojs+react@3.6.19_react@18.2.0/node_modules/@tarojs/react/dist/react.esm.js" for import "flushSync"

    node_modules/.pnpm/@mantine+core@7.2.2_@mantine+hooks@7.2.2_@types+react@18.2.37_react-dom@18.2.0_react@18.2.0/node_modules/@mantine/core/esm/components/Collapse/use-collapse.mjs:3:9:
      3 ‚îÇ import { flushSync } from 'react-dom';

......
```
